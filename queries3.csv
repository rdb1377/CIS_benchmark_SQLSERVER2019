indexDscQueryval1val2,,
1.1Ensure Latest SQL Server Service Packs and Hotfixes are Installed 00000,,
1.2Ensure Single-Function Member Servers are Used 00000,,
2.1<p><h4>2.1 Ensure 'Ad Hoc Distributed Queries' Server Configuration Option is set to '0' (Automated) </h4><br>Profile Applicability: <br>&bull; Level 1 - Database Engine <br>&bull; Level 1 - AWS RDS Description: <br>Enabling Ad Hoc Distributed Queries allows users to query data and execute statements on external data sources. This functionality should be disabled. <br>Rationale: <br>This feature can be used to remotely access and exploit vulnerabilities on remote SQL Server instances and to run unsafe Visual Basic for Application functions.<br>Audit: <br> Run the following T-SQL command: <br>SELECT name, CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use <br>FROM sys.configurations <br>WHERE name = 'Ad Hoc Distributed Queries'; <br>Both value columns must show 0. <br>Remediation: <br>For AWS RDS Instances, please refer to the documentation for using Parameter Groups here: <br> Working with parameter groups Run the following T-SQL command: <br> EXECUTE sp_configure 'show advnced options', 1; <br>RECONFIGURE; <br>EXECUTE sp_configure 'Ad Hoc Distributed Queries', 0; <br>RECONFIGURE; <br>GO <br> EXECUTE sp_configure 'show advanced options', 0; RECONFIGURE; <br>Default Value: <br>0 (disabled) <br> References: <br><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWit hParamGroups.html">link text</a><a href="https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/adhoc-distributed-queries-server-configuration-option">link text</a> <br></p>SELECT name, CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'Ad Hoc Distributed Queries';00
2.2Ensure 'CLR Enabled' Server Configuration Option is set to '0' (Scored)SELECT name, CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'clr enabled';00
2.3Ensure 'Cross DB Ownership Chaining' Server Configuration Option is set to '0'SELECT name, CAST(value as int) as value_configured, CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'cross db ownership chaining';00
2.4Ensure 'Database Mail XPs' Server Configuration Option is set to '0' (Automated)SELECT name, CAST(value as int) as value_configured,CAST(value_in_use as int) as value_in_use FROM sys.configurations WHERE name = 'Database Mail XPs';00
